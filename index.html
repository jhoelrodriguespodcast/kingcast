<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KingCast Podcast</title>
  <style>
    body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin: 0; padding: 20px; }
    h1 { text-align: center; color: #333; }
    .folder { background: #fff; padding: 15px; margin: 15px auto; border-radius: 10px;
              max-width: 600px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer; }
    .folder h2 { margin: 0; }
    .files { display: none; margin-top: 10px; }
    .podcast { margin: 10px 0; }
    audio { width: 100%; margin-top: 5px; }
  </style>
</head>
<body>
  <h1>üéôÔ∏è KingCast Podcast</h1>
  <div id="folders"></div>

  <script>
    const repoOwner = "jhoelrodriguespodcast";
    const repoName = "kingcast";

    async function loadFolders() {
      try {
        // Lista conte√∫do do reposit√≥rio (pasta raiz)
        const res = await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/`);
        const items = await res.json();

        // Pega apenas pastas (como "Deus", etc.)
        const folders = items.filter(item => item.type === "dir");

        const container = document.getElementById("folders");

        for (const folder of folders) {
          const folderDiv = document.createElement("div");
          folderDiv.className = "folder";
          folderDiv.innerHTML = `<h2>${folder.name}</h2>`;

          const filesDiv = document.createElement("div");
          filesDiv.className = "files";

          // Buscar os arquivos dentro da pasta
          const resFiles = await fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${folder.name}`);
          const files = await resFiles.json();
          const mp3Files = files.filter(f => f.name.toLowerCase().endsWith(".mp3"));

          mp3Files.forEach(file => {
            const epDiv = document.createElement("div");
            epDiv.className = "podcast";

            // Gera link RAW do GitHub (streaming direto)
            const rawUrl = `https://raw.githubusercontent.com/${repoOwner}/${repoName}/main/${folder.name}/${file.name}`;

            epDiv.innerHTML = `
              <h3>${file.name.replace(/\.mp3$/i, '')}</h3>
              <audio controls>
                <source src="${rawUrl}" type="audio/mpeg">
                Seu navegador n√£o suporta √°udio HTML5.
              </audio>
            `;
            filesDiv.appendChild(epDiv);
          });

          folderDiv.appendChild(filesDiv);

          // Clicar no t√≠tulo da pasta abre/fecha lista
          folderDiv.querySelector("h2").addEventListener("click", () => {
            filesDiv.style.display = filesDiv.style.display === "none" ? "block" : "none";
          });

          container.appendChild(folderDiv);
        }
      } catch (err) {
        document.getElementById("folders").innerHTML = `
          <p style="color:red;">Erro: ${err.message}</p>
        `;
      }
    }

    loadFolders();
  </script>
</body>
</html>
