function doGet(e) {
  try {
    // Abra sua planilha pelo ID
    var ss = SpreadsheetApp.openById('19bu1iLfR3sNvrlpBnNiG71c9iwq6J0izpZf4Ag8iOP0');

    // Troque o nome da aba se for diferente. Se não existir, usa a primeira.
    var sheet = ss.getSheetByName('Página1');
    if (!sheet) sheet = ss.getSheets()[0];

    // Garante que e.parameter exista (evita erro ao rodar pelo menu "Executar")
    var p = (e && e.parameter) ? e.parameter : {};

    var data = new Date();
    var ip = p.ip || '';
    var cidade = p.cidade || '';
    var pais = p.pais || '';
    var navegador = p.navegador || '';

    sheet.appendRow([data, ip, cidade, pais, navegador]);

    return ContentService
      .createTextOutput('OK')
      .setMimeType(ContentService.MimeType.TEXT);

  } catch (err) {
    return ContentService
      .createTextOutput('ERRO: ' + err.message)
      .setMimeType(ContentService.MimeType.TEXT);
  }
}